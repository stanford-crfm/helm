'use client';
import{__rest as e}from"tslib";import t,{useState as a}from"react";import{BaseColors as o}from"../../../lib/constants.js";import{themeColorRange as l,colorPalette as r}from"../../../lib/theme.js";import{getColorClassNames as i,defaultValueFormatter as n}from"../../../lib/utils.js";import{tremorTwMerge as s}from"../../../lib/tremorTwMerge.js";import{ResponsiveContainer as c,BarChart as m,CartesianGrid as d,XAxis as u,YAxis as v,Tooltip as p,Legend as h,Bar as y}from"recharts";import{constructCategoryColors as f,deepEqual as k,getYAxisDomain as g}from"../common/utils.js";import b from"../common/ChartLegend.js";import w from"../common/ChartTooltip.js";import x from"../common/NoData.js";const E=t.forwardRef(((E,j)=>{const{data:A=[],categories:L=[],index:C,colors:N=l,valueFormatter:O=n,layout:D="horizontal",stack:T=!1,relative:V=!1,startEndOnly:F=!1,animationDuration:K=900,showAnimation:S=!1,showXAxis:G=!0,showYAxis:z=!0,yAxisWidth:M=56,showTooltip:P=!0,showLegend:B=!0,showGridLines:W=!0,autoMinValue:X=!1,minValue:Y,maxValue:I,allowDecimals:R=!0,noDataText:$,onValueChange:q,className:H}=E,J=e(E,["data","categories","index","colors","valueFormatter","layout","stack","relative","startEndOnly","animationDuration","showAnimation","showXAxis","showYAxis","yAxisWidth","showTooltip","showLegend","showGridLines","autoMinValue","minValue","maxValue","allowDecimals","noDataText","onValueChange","className"]),[Q,U]=a(60),Z=f(L,N),[_,ee]=t.useState(void 0),[te,ae]=a(void 0),oe=!!q;function le(e,t,a){var o,l;a.stopPropagation(),q&&(k(_,Object.assign(Object.assign({},e.payload),{value:e.value}))?(ae(void 0),ee(void 0),null==q||q(null)):(ae(null===(o=e.tooltipPayload[0])||void 0===o?void 0:o.dataKey),ee(Object.assign(Object.assign({},e.payload),{value:e.value})),null==q||q(Object.assign({eventType:"bar",categoryClicked:null===(l=e.tooltipPayload[0])||void 0===l?void 0:l.dataKey},e.payload))))}const re=g(X,Y,I);return t.createElement("div",Object.assign({ref:j,className:s("w-full h-80",H)},J),t.createElement(c,{className:"h-full w-full"},(null==A?void 0:A.length)?t.createElement(m,{data:A,stackOffset:V?"expand":"none",layout:"vertical"===D?"vertical":"horizontal",onClick:oe&&(te||_)?()=>{ee(void 0),ae(void 0),null==q||q(null)}:void 0},W?t.createElement(d,{className:s("stroke-1","stroke-tremor-border","dark:stroke-dark-tremor-border"),horizontal:"vertical"!==D,vertical:"vertical"===D}):null,"vertical"!==D?t.createElement(u,{hide:!G,dataKey:C,interval:"preserveStartEnd",tick:{transform:"translate(0, 6)"},ticks:F?[A[0][C],A[A.length-1][C]]:void 0,fill:"",stroke:"",className:s("mt-4 text-tremor-label","fill-tremor-content","dark:fill-dark-tremor-content"),tickLine:!1,axisLine:!1}):t.createElement(u,{hide:!G,type:"number",tick:{transform:"translate(-3, 0)"},domain:re,fill:"",stroke:"",className:s("text-tremor-label","fill-tremor-content","dark:fill-dark-tremor-content"),tickLine:!1,axisLine:!1,tickFormatter:O,padding:{left:10,right:10},minTickGap:5,allowDecimals:R}),"vertical"!==D?t.createElement(v,{width:M,hide:!z,axisLine:!1,tickLine:!1,type:"number",domain:re,tick:{transform:"translate(-3, 0)"},fill:"",stroke:"",className:s("text-tremor-label","fill-tremor-content","dark:fill-dark-tremor-content"),tickFormatter:V?e=>`${(100*e).toString()} %`:O,allowDecimals:R}):t.createElement(v,{width:M,hide:!z,dataKey:C,axisLine:!1,tickLine:!1,ticks:F?[A[0][C],A[A.length-1][C]]:void 0,type:"category",interval:"preserveStartEnd",tick:{transform:"translate(0, 6)"},fill:"",stroke:"",className:s("text-tremor-label","fill-tremor-content","dark:fill-dark-tremor-content")}),t.createElement(p,{wrapperStyle:{outline:"none"},isAnimationActive:!1,cursor:{fill:"#d1d5db",opacity:"0.15"},content:P?({active:e,payload:a,label:o})=>t.createElement(w,{active:e,payload:a,label:o,valueFormatter:O,categoryColors:Z}):t.createElement(t.Fragment,null),position:{y:0}}),B?t.createElement(h,{verticalAlign:"top",height:Q,content:({payload:e})=>b({payload:e},Z,U,te,oe?e=>{return t=e,void(oe&&(t!==te||_?(ae(t),null==q||q({eventType:"category",categoryClicked:t})):(ae(void 0),null==q||q(null)),ee(void 0)));var t}:void 0)}):null,L.map((e=>{var a;return t.createElement(y,{className:s(i(null!==(a=Z.get(e))&&void 0!==a?a:o.Gray,r.background).fillColor,q?"cursor-pointer":""),key:e,name:e,type:"linear",stackId:T||V?"a":void 0,dataKey:e,fill:"",isAnimationActive:S,animationDuration:K,shape:e=>((e,a,o)=>{const{x:l,y:r,width:i,height:n,fillOpacity:s,name:c,payload:m,value:d}=e;return t.createElement("rect",{x:l,y:r,width:i,height:n,opacity:a||o&&o!==c?k(a,Object.assign(Object.assign({},m),{value:d}))?s:.3:s})})(e,_,te),onClick:le})}))):t.createElement(x,{noDataText:$})))}));E.displayName="BarChart";export{E as default};
